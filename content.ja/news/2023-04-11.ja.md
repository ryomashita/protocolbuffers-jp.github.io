+++
title = "2023年4月11日に発表された変更"
linkTitle = "2023年4月11日"
toc_hide = "true"
description = "2023年4月11日にProtocol Buffers向けに発表された変更。"
type = "docs"
+++

## 構文リフレクションの非推奨化 {#deprecation}

v23 では、リフレクションを使用して構文バージョンをチェックする機能が非推奨化されます。この非推奨化はビルド時に警告として含まれます。この機能は将来のリリースで削除されます。

## C++ で ctype=CORD のサポートを追加 {#cord}

v23 では、単数の `bytes` フィールドに対して `ctype=CORD` サポートが追加されます。これには、`oneof` フィールドも含まれ、データが `string` ではなく [`absl::cord`](https://github.com/abseil/abseil-cpp/blob/master/absl/strings/cord.h) を使用して保存されることを指定します。将来のリリースでは、単数の `string` フィールドタイプや `repeated` `string` および `byte` フィールドに対するサポートが、オープンソースコミュニティからの十分な関心があれば追加されるかもしれません。

`ctype=CORD` は拡張機能には影響しません。

フィールドオプションを使用してサポートを追加できます：

```proto
optional bytes foo = 25 [ctype=CORD];
```

## オプションの保持 {#retention}

オプションには、生成されたコードでオプションが保持されるかどうかを制御する *retention* の概念があります。オプションは常に *runtime retention* を持っており、これは生成されたコードで保持され、したがって生成された記述子プールでランタイムで表示されることを意味します。ただし、`retention = RETENTION_SOURCE` を設定して、オプション（またはオプション内のフィールド）がランタイムで保持されないように指定することができます。これを *source retention* と呼びます。

retention の設定は次のようになります：

```proto
extend google.protobuf.FileOptions {
  optional int32 source_retention_option = 1234
      [retention = RETENTION_SOURCE];
}
```

また、プレーンフィールドに設定することもできます。この場合、そのフィールドがオプション内に現れるときにのみ効果があります：

```proto
message OptionsMessage {
  optional int32 source_retention_field = 1 [retention = RETENTION_SOURCE];
}
```

詳細については、[Option Retention](/programming-guides/proto3#option-retention) を参照してください。

## Bazel <5.3 のサポートの廃止 {#bazel}

v23 では、Bazel 4 のサポートが廃止されます。Protobuf は引き続き Bazel 5 LTS をサポートし、最小必要バージョンとして Bazel 5.3 を必要とします。これは、[Foundational C++ Support Policy](https://opensource.google/documentation/policies/cplusplus-support#build_systems) で説明されているビルドサポートポリシーに従い、[Foundational C++ Support](https://github.com/google/oss-policies-info/blob/main/foundational-cxx-support-matrix.md) のバージョンに反映されています。

Please paste the Markdown content you would like me to translate into Japanese.
