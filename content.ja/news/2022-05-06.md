+++
title = "2022年5月6日に発表された変更"
linkTitle = "2022年5月6日"
toc_hide = "true"
description = "2022年5月6日にProtocol Buffersで発表された変更。"
type = "docs"
+++

## バージョニング {#versioning}

私たちは、Protocol Buffersの言語固有の部分をより柔軟に更新するために、バージョニング方式を変更しました。新しい方式では、各言語に独自のメジャーバージョンがあり、他の言語とは独立して増やすことができます。このトピックの後半でPythonリリースで詳しく説明します。ただし、マイナーおよびパッチバージョンは連動したままです。これにより、一部の言語に破壊的な変更を導入することができ、破壊的な変更がない言語ではメジャーバージョンを上げる必要がありません。

この新しいバージョニング方式の最初のインスタンスは、Python APIの新バージョンである4.21.0で、これは前のバージョンである3.20.1に続きます。他の言語APIは3.21.0としてリリースされます。

## Pythonの更新 {#python-updates}

Protocol BuffersのPython言語サポートにいくつかの変更を加えました。バージョン4.21.0は、3.20.1に続く新しいメジャーバージョンです。新しいバージョンは、[upbライブラリ](https://github.com/protocolbuffers/upb)に基づいており、特に大きなペイロードに対して以前のリリースよりも大幅に優れたパース性能を提供します。また、Appleシリコン向けの事前ビルドされたバイナリモジュールも含まれており、手動ビルドなしでパフォーマンスが向上します。

新しいリリースにはいくつかの破壊的な変更が含まれています。具体的には：

*   以前は暗黙的に作成されたクラスに依存していた[`UnknownFields()`](https://googleapis.dev/python/protobuf/3.17.0/google/protobuf/message.html#google.protobuf.message.Message.UnknownFields)メソッドが、明示的に作成された`UnknownFieldSet`クラスに置き換えられました。
*   特定の文字列やエラーメッセージの特定の形式など、非コアの特性が変更されている可能性があります。これらは破壊的な変更とは見なされませんが、既存のコードベースに影響を与える可能性があります。
*   PythonとC++間でメッセージを共有するアプリケーションは、新しいバージョンで壊れます。ほとんどの開発者には影響がないかもしれませんが、[Nucleus](https://github.com/google/nucleus)および他のライブラリのユーザーには影響があるかもしれません。回避策として、互換性を維持するようライブラリに強制する[環境変数を設定](/reference/python/python-generated#sharing-messages)することができます。
*   Python upbは、protoc 3.19.0以降で生成された生成コードが必要です。

## JavaScript サポート {#javascript}

Protocol Buffer の JavaScript サポートに関していくつかの変更を行いました。これにより、JavaScript がメインリポジトリから独立して進化しリリースできるようになりました。具体的には、言語サポートをメインプロジェクトから切り離し、[メインプロジェクト](https://github.com/protocolbuffers/protobuf) から独自のリポジトリである [自身のリポジトリ](https://github.com/protocolbuffers/protobuf-javascript) に移動しました。

Protocol Buffers の JavaScript サポートに関連するプルリクエストを作成していて、まだマージしたいものがある場合は、そのプルリクエストを JavaScript リポジトリに複製してください。GitHub の問題は自動的に移行されます。
